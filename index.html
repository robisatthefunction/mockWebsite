<!DOCTYPE HTML>

<html>
	<head>
		<title>Company</title>
		<meta charset="utf-8" />
		<link href="https://fonts.googleapis.com/css?family=Convergence|Oleo+Script" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Dosis" rel="stylesheet">
		<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<script src="https://unpkg.com/@optimizely/optimizely-sdk/dist/optimizely.browser.umd.min.js"></script>
	<script>
	const urlParams = new URLSearchParams(window.location.search);

	  var maskTimeout = parseInt(urlParams.get('timeout')),
      hideElementSelectors = ['body > header > h1', '.text-nav'],
      syncChangesApplied   = false,
	  override = urlParams.get('override');    

  /**
  * Manages CSSStyleSheet actions
  * Handles adding and removing rules from our "masking" sheet
  */
  var cssRuleManager = {
    sheet: (function() {
      // https://davidwalsh.name/add-rules-stylesheets
      var style = document.createElement("style");
      style.appendChild(document.createTextNode(""));
      document.head.appendChild(style);
      return style.sheet;
    })(),
    addCSSRule: function(selector, rules) {
      if ("insertRule" in this.sheet) {
        this.sheet.insertRule(selector + "{" + rules + "}", 0);
      } else if ("addRule" in this.sheet) {
        this.sheet.addRule(selector, rules, 0);
      }
    }
  }  

  /**
  * Fired in the first call of Optimizely `action.applied`
  * Disables "masking" stylesheet
  */
  var removeMask = function() {
    // its adequate to remove mask class once on the first sync change
    if(syncChangesApplied) return;
    cssRuleManager.sheet.disabled = true;
    syncChangesApplied = true;
  }

  /**
  * Creates all CSSRules based on supplied list of selectors to hide
  * Binds Optimizely `action.applied` to unhide nodes by removing CSSRules
  */
  hideElementSelectors.forEach(function(selector) {
    cssRuleManager.addCSSRule(selector, 'visibility:hidden');
  });

  /**
  * Listen for first sync change applied
  * and unmask nodes
  */
  window.optimizely = window.optimizely || [];
  window.optimizely.push({
    type: "addListener",
    filter: {
      type: "lifecycle",
      name: "campaignDecided"
    },
    "handler": removeMask
  });  

  setTimeout(removeMask, maskTimeout);

		const userId = urlParams.get('userId')
		const sdkKey = urlParams.get('sdkKey')
		const attributes = {tier: urlParams.get('tier')};
	//	const optimizelyOptions = optimizelySdk.OptimizelyDecideOption;

window.optimizelySdk = optimizelySdk;

		optimizelySdk.setLogger(optimizelySdk.logging.createLogger());
		optimizelySdk.setLogLevel(optimizelySdk.enums.LOG_LEVEL.DEBUG);

// PiRA8qU33qXi5aCoT7yH6
// https://robisatthefunction.github.io/mockWebsite/?sdkKey=JtG4rUnwTxcpXCVNFND9W

const optimizelyClient = optimizelySdk.createInstance({
	sdkKey: sdkKey
})

	 	optimizelyClient.onReady().then(result => {
		  window.optimizelyClient = optimizelyClient

	const onDecision = ({decisionType, userId, attributes, decisionInfo}) => {
	if(decisionInfo['decisionEventDispatched']){
		window.dataLayer = window.dataLayer || [];
		dataLayer.push({
  			'event': 'optimizely-decision',
  			'optimizely-flagKey': decisionInfo.flagKey,
  			'optimizely-ruleKey': decisionInfo.ruleKey,
  			'optimizely-variationKey': decisionInfo.variationKey,
		});
	}
}

const notificationId = optimizelyClient.notificationCenter.addNotificationListener(optimizelySdk.enums.NOTIFICATION_TYPES.DECISION, onDecision);
			//console.log('reason', result.reason);

		//	var config = optimizelyClient.getOptimizelyConfig();

		//	var decisionEvent = (config['featuresMap']['example']['variablesMap']['disable_decision_event'].value == 'true') ? optimizelyOptions.DISABLE_DECISION_EVENT : null;

//var user = optimizelyClient.createUserContext(userId, attributes);
			//var decision = user.decide('example', [decisionEvent]);

		//	if (decision['enabled']){
		//		document.querySelector('head > link:nth-child(12)').setAttribute('href', 'css/main2.css');
		//		document.querySelector('#content > section > div.work.nav.col-md-6 > h2 > span').innerText = decision['variables'].brand_messaging;
		//	}

			document.querySelectorAll('.text-nav').forEach(item => {
	  		item.addEventListener('click', event => {
				optimizelyClient.track('click', userId);
			})
		});
//		window.decision = decision;
		window.config = config;
	});

		</script>



    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
		<link rel="stylesheet" href="css/font-awesome.min.css">
		<link rel="stylesheet" href="css/main.css"/>
	</head>
	<body>
		<header class="sticky-header">
			<h1>Company Name</h1>
		</header>
		<div id="body">
		<div id="content">
		<section>
			<div class="work nav col-md-6">
					<h2 class="text-nav"><span style="font-size:20px">CTA</span></h2>
			</div>
			<div class="contact nav col-md-6">
					<h2 class="text-nav"><span style="font-size:20px">CTA</span></h2>
			</div>
			<div class="about nav col-md-6">
					<h2 class="text-nav"><span style="font-size:20px">CTA</span></h2>
			</div>
			<div class="careers nav col-md-6">
					<h2 class="text-nav"><span style="font-size:20px">CTA</span></h2>
			</div>
		</section>
		</div>

				<!-- Footer -->
					<footer id="footer">

					</footer>

		</div>


		<!-- Scripts -->
		<script src="https://cdn.optimizely.com/js/9874509362.js"></script>
	</body>
</html>
